# 감정 일기 앱 - 기능 명세서 (사용자 플로우 기준)

## 목차

### 1. 앱 시작 및 초기 진입 플로우

- 1.1 랜딩 페이지 진입
- 1.2 로그인 플로우
- 1.3 회원가입 플로우
- 1.4 비밀번호 찾기 플로우

### 2. 최초 사용자 설정 플로우

- 2.1 페르소나 설정 (회원가입 직후)

### 3. 일기 작성 플로우

- 3.1 일기 작성 시작
- 3.2 일기 내용 작성
- 3.3 일기 작성 저장 및 처리
- 3.4 감정 분석 결과 표시 (일기 작성 후)
- 3.5 일기 작성 취소

### 4. 일기 수정 플로우

- 4.1 일기 수정 시작
- 4.2 일기 내용 수정
- 4.3 일기 수정 저장 및 처리
- 4.4 일기 수정 취소

### 5. 일기 조회 및 관리 플로우

- 5.1 캘린더 화면 조회
- 5.2 일기 상세보기

### 6. 일기 검색 플로우

- 6.1 검색 화면 진입
- 6.2 검색 실행
- 6.3 검색 결과 상세보기

### 7. 감정 통계 조회 플로우

- 7.1 통계 화면 진입
- 7.2 뷰 모드 선택
- 7.3 캘린더 뷰
- 7.4 타임라인 뷰
- 7.5 차트 뷰

### 8. 장소 추천 플로우

- 8.1 장소 추천 시작
- 8.2 장소 추천 화면

### 9. 위험 신호 감지 플로우

- 9.1 자동 위험 분석
- 9.2 위험 알림 모달 표시
- 9.3 지원 리소스 페이지

### 10. 마이페이지 및 설정 변경 플로우

- 10.1 마이페이지 진입
- 10.2 프로필 정보 확인 및 수정
- 10.3 비밀번호 변경
- 10.4 공지사항 조회
- 10.5 계정 탈퇴

### 11. 로그아웃 플로우

- 11.1 로그아웃 실행

### 12. 네비게이션 플로우

- 12.1 북마크 네비게이션

### 13. 데이터 동기화 및 자동 업데이트

- 13.1 자동 새로고침

### 14. 에러 처리 플로우

- 14.1 입력 검증 에러
- 14.2 API 에러
- 14.3 로딩 상태

### 15. 특수 기능 및 상호작용

- 15.1 키보드 단축키

---

## 1. 앱 시작 및 초기 진입 플로우

### 1.1 랜딩 페이지 진입

**화면 전환**:

- 앱 열기 → 랜딩 페이지 표시
- 일기장 표시
- 일기장 진입 기능 제공

**시스템 처리**:

- 일기장 진입 시 로그인 상태 확인
- 로그인 상태 있음 → 다이어리 메인(캘린더) 화면으로 이동
- 로그인 상태 없음 → 로그인 페이지로 이동

---

### 1.2 로그인 플로우

**화면 전환**:

- 로그인 페이지로 이동

**로그인 기능**:

1. 이메일 입력

   - 이메일 입력 필드 제공
   - 실시간 검증 없음

2. 비밀번호 입력

   - 비밀번호 입력 필드 제공
   - 비밀번호 표시/숨김 기능 제공
   - 실시간 검증 없음

3. 로그인 실행
   - 로그인 실행 기능 제공
   - 클라이언트 검증 없이 즉시 로그인 API 호출
   - 로딩 상태 표시

**로그인 성공 시**:

- 토큰 저장 (accessToken, refreshToken)
- 사용자 정보 localStorage 저장
- 다이어리 메인(캘린더) 화면으로 이동

**로그인 실패 시**:

- 서버에서 검증 (이메일 형식, 빈 필드, 비밀번호 불일치 등)
- 통합 에러 메시지 표시
- 필드별 에러 메시지 없음

**로그인 페이지 내 네비게이션**:

- 회원가입 페이지로 이동하는 기능 제공
- 비밀번호 찾기 페이지로 이동하는 기능 제공
- 랜딩 페이지로 돌아가는 기능 제공

---

### 1.3 회원가입 플로우

**화면 전환**:

- 회원가입 페이지로 이동

**회원가입 기능**:

1. 이름 입력

   - 이름 입력 필드 제공
   - 시스템: 실시간 검증 (2자 이상)
   - 조건 미충족 시 → 에러 메시지 표시

2. 이메일 입력 및 중복 확인

   - 이메일 주소 입력 필드 제공
   - 이메일 중복 확인 기능 제공 → 서버에 이메일 중복 확인 요청
   - 중복 없음 → 성공 메시지 표시
   - 이미 가입된 이메일 → 에러 메시지 표시
   - 중복 확인 완료 후 이메일 인증 진행

3. 이메일 인증 코드 발송

   - 중복 확인 완료 후 인증 코드 발송 기능 제공
   - 인증 코드 발송 실행 → 서버에서 이메일로 6자리 인증 코드 발송
   - 성공 메시지 표시
   - 인증 코드 유효 시간: **5분** (발송 시점부터 계산)
   - 발송 후 인증 코드 입력 단계 진행

4. 이메일 인증 코드 확인

   - 6자리 인증 코드 입력 필드 제공
   - 남은 시간 표시 기능 제공
   - 인증 확인 기능 제공 → 서버에서 코드 검증 및 유효 시간 확인
   - 인증 성공 → 성공 메시지 표시
   - 인증 실패 (코드 불일치) → 에러 메시지 표시
   - 인증 실패 (시간 만료) → 에러 메시지 표시
   - 시간 만료 시 → 인증 코드 입력 불가, 재발송 필요
   - 인증 코드 재발송 기능 제공 → 새 인증 코드 발송 (5분 시간 리셋)
   - 인증 완료 후 다음 단계 진행 가능

5. 비밀번호 입력

   - 비밀번호 입력 필드 제공
   - 시스템: 실시간 검증 (최소 8자, 영문/숫자/특수문자 포함)
   - 조건 미충족 시 → 에러 메시지 표시

6. 비밀번호 확인 입력

   - 비밀번호 확인 입력 필드 제공
   - 시스템: 비밀번호 일치 여부 실시간 검증
   - 불일치 시 → 에러 메시지 표시

7. 성별 선택

   - 성별 선택 라디오 버튼 제공 (남성 / 여성)
   - 필수 선택 항목 (AI 그림일기 주인공 성별 결정에 사용됨)
   - 미선택 시 → 에러 메시지 표시

8. 필수 약관 동의

   - 필수 약관만 존재 (서비스 이용약관, 개인정보 처리방침 등)
   - 전체 약관 동의/해제 기능 제공 → 모든 약관 일괄 동의/해제
   - 개별 약관 선택 기능 제공 → 해당 약관만 동의/해제
   - 약관 상세 내용 확인 기능 제공
   - **참고**: 마케팅 정보 수신 동의 등 선택 약관은 없음

9. 회원가입 실행
   - 회원가입 실행 기능 제공
   - 시스템: 모든 필수 항목 최종 검증
   - 이메일 중복 확인 미완료 → 에러 메시지 표시
   - 이메일 인증 미완료 → 에러 메시지 표시
   - 필수 약관 미동의 → 에러 메시지 표시
   - 모든 조건 충족 → 회원가입 API 호출

**회원가입 성공 시**:

- 토큰 저장 (accessToken, refreshToken)
- 사용자 정보 localStorage 저장
- **페르소나 설정 화면으로 자동 이동**

**회원가입 실패 시**:

- 에러 메시지 표시

**회원가입 페이지 내 네비게이션**:

- 로그인 페이지로 돌아가는 기능 제공

---

### 1.4 비밀번호 찾기 플로우

**화면 전환**:

- 비밀번호 찾기 페이지로 이동

**단계 1: 이메일 입력**

- 이메일 입력 필드 제공
- 인증 코드 발송 기능 제공
- 시스템: 이메일 형식 검증 → API 호출 → 인증 코드 이메일 발송
- 인증 코드 유효 시간: **5분** (발송 시점부터 계산)
- 성공 시: 단계 2로 이동

**단계 2: 인증 코드 확인**

- 6자리 인증 코드 입력 필드 제공
- 남은 시간 표시 기능 제공
- 인증 확인 기능 제공
- 시스템: 코드 검증 및 유효 시간 확인
- 인증 성공 → 단계 3으로 이동
- 인증 실패 (코드 불일치) → 에러 메시지 표시
- 인증 실패 (시간 만료) → 에러 메시지 표시
- 시간 만료 시 → 인증 코드 입력 불가
- 인증 코드 재발송 기능 제공 → 새 인증 코드 발송 (5분 시간 리셋)

**단계 3: 새 비밀번호 설정**

- 새 비밀번호 입력 필드 제공 (표시/숨김 기능 제공)
- 시스템: 실시간 검증 (최소 8자, 영문/숫자/특수문자 포함)
- 조건 미충족 시 → 에러 메시지 표시
- 새 비밀번호 확인 입력 필드 제공 (표시/숨김 기능 제공)
- 시스템: 비밀번호 일치 여부 실시간 검증
- 불일치 시 → 에러 메시지 표시
- 비밀번호 변경 실행 기능 제공
- 검증 통과 → 비밀번호 재설정 API 호출

**재설정 완료 시**:

- 성공 메시지 표시
- 일정 시간 후 자동으로 로그인 페이지로 이동

---

## 2. 최초 사용자 설정 플로우

### 2.1 페르소나 설정 (회원가입 직후)

**화면 전환**:

- 회원가입 완료 후 자동으로 페르소나 설정 페이지로 이동
- 페르소나가 설정되지 않은 상태에서만 진입 가능

**참고**: 페르소나 설정은 필수입니다. 페르소나를 선택하지 않으면 다음 단계로 진행할 수 없습니다.

**단계 1: 환영 화면**

- 환영 메시지 및 앱 소개
- AI 친구 기능 설명
- 다음 단계로 진행하는 기능 제공 → 단계 2로 이동

**단계 2: 페르소나 선택**

- 6가지 페르소나 선택 기능 제공:
  - 베프 (친근하고 공감적)
  - 부모님 (따뜻하고 지지적)
  - 전문가 (전문적이고 분석적)
  - 멘토 (동기부여하는 성장 코치)
  - 상담사 (심리 분석 중심 치유자)
  - 시인 (감성적이고 철학적)
- 페르소나 선택 시 선택 상태 표시
- 선택 시: 해당 페르소나 말투 예시 표시 기능 제공
- **시작하기 기능**:
  - 페르소나 미선택 시: 비활성화 상태
  - 페르소나 선택 후: 활성화 상태
  - 실행 시 → 저장 및 완료 처리

**저장 및 완료**:

- 선택한 페르소나 저장
- 설정 완료 처리
- **다이어리 메인(캘린더) 화면으로 이동**

---

## 3. 일기 작성 플로우

### 3.1 일기 작성 시작

**화면 전환**:

- 캘린더 화면에서 날짜 선택 → 일기 상세보기 페이지 표시
- 해당 날짜에 일기 없음 → 일기 작성 기능 실행
- 일기 작성 페이지로 이동

**화면 전환**:

- 일기 작성 페이지로 이동
- 빈 입력 필드로 시작
- 북마크 네비게이션 표시 (다른 페이지로 이동 가능)

---

### 3.2 일기 내용 작성

**일기 작성 페이지에서 입력 가능한 정보**:

1. **제목 입력** (필수)

   - 제목 입력 필드 제공
   - 빈 값일 경우 저장 불가

2. **본문 작성** (필수)

   - 본문 텍스트 영역 제공
   - 줄바꿈 지원

3. **기분 입력** (선택)

   - 기분 입력 필드 제공
   - 자유 텍스트 입력 가능

4. **날씨 선택** (선택)

   - 날씨 선택 기능 제공
   - 선택 옵션: 맑음, 흐림, 비, 천둥, 눈, 안개

5. **활동 추가** (선택)

   - 활동 입력 및 태그 추가 기능 제공
   - Enter 키 입력 또는 추가 버튼으로 활동 태그 추가
   - 활동 태그 삭제 기능 제공
   - 여러 활동 추가 가능

6. **사용자 이미지 추가** (선택)
   - 이미지 업로드 기능 제공
   - 파일 선택 다이얼로그를 통한 이미지 파일 선택 (JPG, PNG 등 지원)
   - 파일 업로드 진행 → 서버에 이미지 업로드
   - 업로드 완료 후 이미지 미리보기 표시
   - 여러 이미지 추가 가능
   - 추가된 이미지 삭제 기능 제공 (서버에서도 삭제)
   - **참고**: AI가 생성하는 그림일기 이미지와는 별개로, 사용자가 직접 추가하는 사진입니다

---

### 3.3 일기 작성 저장 및 처리

**일기 작성 완료 실행**:

- 시스템: 제목, 본문 필수 항목 검증
- 검증 실패 → 저장 불가

**검증 통과 시**:

- 로딩 상태 표시
- **KoBERT 모델을 통한 감정 분석 (일기 본문 분석)**
  - 일기 본문(`content`)만 분석하여 7가지 감정 중 하나로 분류
  - 분석 결과: 행복, 중립, 당황, 슬픔, 분노, 불안, 혐오
  - 감정 분석 결과 획득 (예: "슬픔")
  - KoBERT 분석 결과가 사용자에게 표시되는 감정이 됨
- AI 이미지 생성 시작 (로딩 상태 표시)
  - 일기 본문(`content`), 날씨(`weather`), 사용자 성별(`gender`) 정보를 활용
  - 나노바나나 API를 통해 일기 내용과 감정 뉘앙스, 사용자 성별을 반영한 그림일기 형태의 이미지 생성
  - 생성 완료 → 이미지 URL 획득

**일기 저장 API 호출**:

- 일기 데이터 전송 (제목, 본문, 기분, 날씨, 활동, 사용자 업로드 이미지 URL 목록 (배열), KoBERT 감정 분석 결과, AI 생성 이미지 URL)
- 감정 분석 결과는 `emotion` 컬럼에 저장됨
- AI 생성 이미지 URL은 별도 컬럼에 저장됨
- 저장 성공 → AI 코멘트 생성
  - 제미나이 API를 통한 AI 코멘트 생성
    - 일기 본문(`content`)과 날씨(`weather`), KoBERT 감정 분석 결과, 페르소나 스타일을 반영하여 생성
- 음식 추천 생성
  - 제미나이 API를 통한 음식 추천 생성
    - 일기 본문(`content`)과 날씨(`weather`), KoBERT 감정 분석 결과를 반영하여 추천 음식 1개 생성
    - 추천된 음식을 DB에 저장

---

### 3.4 감정 분석 결과 표시 (일기 작성 후)

**화면 전환**:

- 일기 작성 완료 후 감정 분석 결과 표시

**표시 내용**:

- **KoBERT가 분석한 감정 이모지**
  - 행복(😊), 중립(😐), 당황(😳), 슬픔(😢), 분노(😠), 불안(😰), 혐오(🤢)
- **KoBERT가 분석한 감정 카테고리**
  - 긍정: 행복
  - 중립: 중립, 당황
  - 부정: 슬픔, 분노, 불안, 혐오
- **AI 생성 이미지(그림일기)** (나노바나나 API로 생성된 이미지)
- **AI 코멘트** (제미나이 API로 생성, 선택한 페르소나 말투로 작성)
  - 일기 내용과 KoBERT 감정 분석 결과를 반영하여 생성
- 감정별로 구분하여 표시

**사용자 선택지**:

1. **장소 추천 기능**

   - 실행 → 장소 추천 화면으로 이동
   - 결과 표시 닫기

2. **닫기 기능**
   - 실행 → 방금 작성한 일기의 상세보기 페이지로 이동
   - 해당 날짜 일기 내용 확인 가능

**분석 실패 시**:

- 에러 메시지 표시
- 확인 기능 제공 → 방금 작성한 일기의 상세보기 페이지로 이동

---

### 3.5 일기 작성 취소

**일기 작성 취소 실행**:

- 시스템: 작성된 내용이 있는지 확인
  - 내용 없음 → 즉시 캘린더로 이동
  - 내용 있음 → 취소 확인 기능 표시
- **취소 확인**:
  - 취소 확인 메시지 표시
  - 취소 확인 실행:
    - 이미 업로드된 사용자 이미지가 있는 경우 → 서버에서 업로드된 이미지 파일 삭제 API 호출
    - 작성 내용 삭제
    - 캘린더 화면으로 이동
  - 계속 작성 선택 → 작성 페이지로 복귀

**북마크 네비게이션 클릭 시**:

- 일기 작성 중 다른 페이지로 이동 시도 시 → 경고 기능 표시
- **경고 확인**:
  - 경고 메시지 표시
  - 이동 확인 실행:
    - 이미 업로드된 사용자 이미지가 있는 경우 → 서버에서 업로드된 이미지 파일 삭제 API 호출
    - 작성 내용 삭제
    - 선택한 페이지로 이동
  - 계속 작성 선택 → 작성 페이지로 복귀

---

## 4. 일기 수정 플로우

### 4.1 일기 수정 시작

**화면 전환**:

- 캘린더 화면에서 날짜 선택 → 일기 상세보기 페이지 표시
- 해당 날짜에 일기 있음 → 일기 수정 기능 실행
- 일기 작성 페이지로 이동

**화면 전환**:

- 일기 작성 페이지로 이동
- 일기 작성 페이지 진입 시 기존 일기 데이터 자동 로드
- 기존 내용이 각 입력 필드에 자동 표시됨
- 사용자가 내용 수정 가능
- 북마크 네비게이션 표시 (다른 페이지로 이동 가능)

---

### 4.2 일기 내용 수정

**일기 작성 페이지에서 수정 가능한 정보** (기존 내용이 각 필드에 표시됨):

1. **제목 수정** (필수)

   - 기존 제목이 입력 필드에 표시됨
   - 수정 가능

2. **본문 수정** (필수)

   - 기존 본문 내용이 텍스트 영역에 표시됨
   - 내용 수정 및 편집 가능
   - 줄바꿈 지원

3. **기분 수정** (선택)

   - 기존 기분이 입력 필드에 표시됨
   - 수정 가능

4. **날씨 수정** (선택)

   - 기존 날씨가 선택된 상태로 표시됨
   - 수정 가능 (맑음, 흐림, 비, 천둥, 눈, 안개)

5. **활동 수정** (선택)

   - 기존 활동 태그들이 모두 표시됨
   - 활동 태그 추가 및 삭제 가능 (3.2 일기 내용 작성과 동일)

6. **사용자 이미지 수정** (선택)
   - 기존 사용자 업로드 이미지들이 미리보기로 표시됨
   - 이미지 추가 및 삭제 가능 (3.2 일기 내용 작성과 동일)

---

### 4.3 일기 수정 저장 및 처리

**일기 수정 완료 실행**:

- 시스템: 제목, 본문 필수 항목 검증
- 검증 실패 → 저장 불가

**검증 통과 시**:

- 로딩 상태 표시
- AI 생성 이미지 (그림일기): 수정된 일기 내용과 사용자 성별을 반영하여 이미지 재생성
- 사용자 업로드 이미지: 수정된 내용 유지 (삭제/추가된 이미지 반영)

**일기 수정 API 호출**:

- 수정된 일기 데이터 전송 (제목, 본문, 기분, 날씨, 활동, AI 생성 이미지 URL, 사용자 업로드 이미지 URL 목록 (배열))
- 저장 성공 → 감정 분석 및 AI 코멘트, AI 이미지 재생성
  - KoBERT 모델을 통한 감정 분석 (수정된 일기 본문 분석)
    - 수정된 본문을 분석하여 7가지 감정 중 하나로 재분류
    - 주요 감정을 추출하여 `emotion` 컬럼에 업데이트
    - 참고: 일기 수정 시 내용을 반영하여 AI 이미지(그림일기)도 새로 생성됨
  - 제미나이 API를 통한 AI 코멘트 재생성
    - 수정된 일기 내용(본문, 날씨)과 KoBERT 감정 분석 결과, 페르소나 스타일을 반영하여 새로운 AI 코멘트 생성
- 음식 추천 재생성
  - 제미나이 API를 통한 음식 추천 재생성
    - 수정된 일기 내용(본문, 날씨)과 KoBERT 감정 분석 결과를 반영하여 추천 음식 1개 재생성
    - 재생성된 음식을 DB에 업데이트

**수정 완료 후**:

- 감정 분석 모달 표시 안 함
- 바로 해당 날짜 일기 상세보기 페이지로 이동
- 업데이트된 AI 코멘트 확인 가능

---

### 4.4 일기 수정 취소

**일기 수정 취소 실행**:

- 시스템: 수정된 내용이 있는지 확인
  - 수정 내용 없음 → 즉시 일기 상세보기로 이동
  - 수정 내용 있음 → 취소 확인 기능 표시
- **취소 확인**:
  - 취소 확인 메시지 표시
  - 취소 확인 실행 → 수정 내용 삭제 → 일기 상세보기로 이동 (원본 내용 유지)
  - 계속 수정 선택 → 수정 페이지로 복귀

**북마크 네비게이션 클릭 시**:

- 일기 수정 중 다른 페이지로 이동 시도 시 → 경고 기능 표시
- **경고 확인**:
  - 경고 메시지 표시
  - 이동 확인 실행:
    - 수정 내용 삭제 (원본 내용 유지)
    - 새로 추가했던 사용자 업로드 이미지가 있는 경우 → 서버에서 새로 추가한 이미지 삭제 API 호출
    - 선택한 페이지로 이동
  - 계속 수정 선택 → 수정 페이지로 복귀

---

## 5. 일기 조회 및 관리 플로우

### 5.1 캘린더 화면 조회

**화면 전환**:

- 캘린더 메인 화면으로 이동
- 현재 월 캘린더 표시

**초기 로드**:

- 시스템: 현재 월 감정 데이터 자동 로드
- 현재 월 캘린더 표시
- 각 날짜별 감정 이모지 표시
- 월 이동 기능 제공 (이전 달/다음 달)

**월 이동**:

- 이전 달 이동 기능 제공 → 이전 달 캘린더로 전환
- 다음 달 이동 기능 제공 → 다음 달 캘린더로 전환
- 해당 월 감정 데이터 자동 로드

**날짜 선택**:

- 캘린더에서 날짜 선택
- 해당 날짜의 일기 상세보기로 이동

**날짜 표시**:

- 오늘 날짜 표시
- 선택된 날짜 표시
- 작성된 일기가 있는 날짜: 감정 이모지 표시

---

### 5.2 일기 상세보기

**화면 전환**:

- 캘린더에서 날짜 클릭 → 일기 상세보기 페이지로 이동
- 해당 날짜의 일기 데이터 로드

**표시 내용**:

- 날짜 및 요일
- 제목
- 감정 이모지 및 감정 카테고리 (예: 😊 행복)
- 기분
- 활동 태그
- 날씨
- 본문 내용
- AI 생성 이미지 (그림일기)
- 사용자 업로드 이미지 (사용자가 직접 추가한 사진, 있는 경우)
- AI 코멘트 (선택한 페르소나 말투)

**사용자 액션**:

1. **일기 수정 기능**

   - 실행 → 일기 작성 페이지로 이동 (기존 내용 로드)

2. **장소 추천 기능**

   - 실행 → 장소 추천 화면으로 이동
   - 감정 카테고리 기반으로 주변 장소 추천

3. **일기 삭제 기능**

   - 실행 → 삭제 확인 기능 표시
   - 삭제 확인 실행 → 일기 삭제 API 호출
   - 삭제 성공 시:
     - 해당 날짜의 일기 데이터 삭제
     - 캘린더 화면으로 이동
     - 해당 날짜의 감정 이모지 자동 제거 (빈 날짜로 표시)
   - 취소 선택 → 확인 기능 닫기

4. **다른 날짜로 이동**

   - 캘린더로 돌아가기 또는 날짜 선택 기능 제공
   - 다른 날짜 선택 시 → 해당 날짜의 일기 상세보기로 이동

5. **캘린더로 돌아가기**
   - 뒤로가기 또는 닫기 기능 제공
   - 캘린더 화면으로 이동

**일기 없는 경우**:

- 안내 메시지 표시
- 일기 작성 기능 제공 → 일기 작성 페이지로 이동

---

## 6. 일기 검색 플로우

### 6.1 검색 화면 진입

**화면 전환**:

- 북마크 네비게이션에서 일기 검색 기능 실행
- 일기 검색 페이지로 이동

---

### 6.2 검색 실행

**검색 기능**:

1. **키워드 검색**

   - 검색창에 키워드 입력 (제목 또는 내용에서 검색)
   - 검색 실행 기능 제공 또는 Enter 키 입력
   - 검색 API 호출 → 결과 표시

2. **필터 사용**

   - 필터 기능 제공
   - 필터 옵션:
     - **기간 검색**: 시작일/종료일 선택
     - **감정 필터**: 감정 카테고리 선택 (행복, 중립, 당황, 슬픔, 분노, 불안, 혐오)
       - 여러 감정 카테고리 중복 선택 가능
       - KoBERT 분석 결과 기준
       - 선택된 감정 중 하나라도 포함된 일기를 검색 결과에 표시
   - 필터 변경 시 자동으로 검색 실행
   - 필터 초기화 기능 제공

3. **검색 결과 확인**

   - 총 일기 개수 표시
   - 검색 결과 목록 표시 (최신순)
   - 각 항목 표시:
     - 날짜 (월, 일, 요일)
     - 감정 이모지 및 카테고리
     - 제목
     - 내용 미리보기
     - 날씨 정보

4. **페이지네이션**
   - 검색 결과가 많을 경우 페이지 분할
   - 한 페이지당 10개의 일기 항목 표시
   - 이전/다음 페이지 이동 기능 제공
   - 현재 페이지 / 전체 페이지 표시

**도움말**:

- 검색 방법 안내 제공

---

### 6.3 검색 결과 상세보기

**화면 전환**:

- 검색 결과 목록에서 일기 항목 클릭
- 해당 일기의 상세보기로 이동 또는 표시

**상태 유지**:

- 검색 키워드 및 필터 상태 유지
- 페이지네이션 상태 유지

**뒤로가기**:

- 닫기 또는 뒤로가기 기능 제공
- 검색 결과 목록으로 돌아가기
- 검색 키워드 및 필터 상태 유지

---

## 7. 감정 통계 조회 플로우

### 7.1 통계 화면 진입

**화면 전환**:

- 북마크 네비게이션에서 감정 통계 기능 실행
- 감정 통계 페이지로 이동

---

### 7.2 뷰 모드 선택

**뷰 모드**:

- 3가지 뷰 모드 제공:
  1. **캘린더 뷰** (기본)
  2. **타임라인 뷰**
  3. **차트 뷰**

**뷰 모드 전환**:

- 뷰 모드 선택 기능 제공 → 해당 뷰로 전환
- 각 뷰 모드별로 다른 데이터 표시 방식

---

### 7.3 캘린더 뷰

**캘린더 표시**:

- 월간 캘린더 그리드 표시
- 각 날짜별 감정 표시 (이모지)
- 월 이동 기능 제공 (이전 달/다음 달)
- 날짜 호버 시 일기 제목 정보 표시 기능 제공

**날짜 선택**:

- 날짜 선택 → 해당 날짜 요약 정보 표시
- 요약 정보:
  - 날짜
  - 감정 이모지
  - 일기 제목
  - 상세보기 기능 제공

**상세보기**:

- 상세보기 기능 실행 → 해당 날짜 일기 상세보기로 이동 또는 표시
- 상세보기에서 뒤로가기 → 요약 정보로 돌아가기

**감정 범례**:

- 선택된 날짜 없을 때 감정 범례 표시

---

### 7.4 타임라인 뷰

**타임라인 목록**:

- 해당 월 작성된 일기 목록 표시 (날짜순)
- 각 항목 표시:
  - 날짜 (월, 일, 요일)
  - 감정 이모지 및 카테고리
  - 제목

**항목 선택**:

- 항목 선택 → 해당 날짜 요약 정보 표시
- 요약 정보:
  - 날짜
  - 감정 이모지
  - 일기 제목
  - 상세보기 기능 제공

**상세보기**:

- 상세보기 기능 실행 → 해당 날짜 일기 상세보기로 이동 또는 표시
- 상세보기에서 뒤로가기 → 요약 정보로 돌아가기

**감정 범례**:

- 선택된 항목 없을 때 감정 범례 표시

---

### 7.5 차트 뷰

**기간 선택**:

- 주간/월간 단위 전환 기능 제공
  - 주간 선택: 최근 7일의 감정 분포 표시
  - 월간 선택: 선택한 월의 감정 분포 표시
- 이전/다음 버튼으로 월 또는 주 이동 기능 제공
- 현재 표시 중인 기간 표시

**감정 변화 추이 그래프**:

- 감정 변화 추이 그래프 표시
- X축: 날짜 (주간 선택 시 일별, 월간 선택 시 주별)
- Y축: 감정 발생 빈도
- 각 감정별로 구분 (행복, 중립, 당황, 슬픔, 분노, 불안, 혐오) - KoBERT 분석 결과 기준
- 그래프 데이터 포인트 호버 시 해당 날짜의 감정 정보 표시 기능 제공

**감정 범례 및 안내**:

- 감정 범례 표시 (각 감정별 설명)
- 차트 읽는 방법 안내 제공

---

## 8. 장소 추천 플로우

### 8.1 장소 추천 시작

**화면 전환**:

- **경로 A**: 일기 저장 후 감정 분석 결과 표시에서 장소 추천 기능 실행 → 장소 추천 화면으로 이동
- **경로 B**: 일기 상세보기 화면에서 장소 추천 기능 실행 → 장소 추천 화면으로 이동
  - 해당 일기의 저장 시점 KoBERT 감정 분석 결과와 일기 내용 기반으로 장소 추천

---

### 8.2 장소 추천 화면

**화면 전환**:

- 장소 추천 화면으로 이동

**현재 위치 확인**:

- 브라우저 위치 API 또는 GPS를 통한 현재 위치 획득
- 위치 획득 성공 → 현재 위치를 지도에 표시
- 위치 획득 실패 → 기본 위치 또는 에러 메시지 표시

**카카오 지도 표시**:

- 카카오 맵 API를 통한 지도 렌더링
- 현재 위치 중심으로 지도 표시
- 지도 컨트롤 기능 제공:
  - 줌 인/아웃
  - 지도 타입 전환 (일반지도, 스카이뷰, 하이브리드)
  - 현재 위치 재확인

**마커 표시**:

- 현재 위치 마커: 사용자 위치 표시
- 추천 장소 마커: 장소 목록의 각 장소 위치에 마커 표시
- 마커 선택 → 해당 장소 항목 강조 표시 및 상세 정보 표시

**AI 기반 음식 추천**:

- 일기 저장 시점에 추천된 음식 조회 (DB에서 조회)
- 추천 음식 표시
- 추천 근거 표시

**카카오 로컬 API 장소 검색**:

- AI가 추천한 음식을 키워드로 카카오 로컬 API 호출
- 현재 위치 기준 반경 5km 이내 장소 검색
- 검색 결과 최대 15개까지 표시

**장소 목록 표시**:

- 각 장소 정보 표시
- 각 항목 표시 내용:
  - 이름: 장소명
  - 카테고리: 음식점 카테고리 (예: 한식, 양식, 카페 등)
  - 평점: 리뷰 평점 (있는 경우)
  - 거리: 현재 위치로부터의 거리 (m 또는 km 단위)

**정렬 옵션**:

- 거리순 정렬 (기본)
- 평점순 정렬
- 이름순 정렬

**장소 항목 선택**:

- 해당 장소의 지도 마커로 지도 중심 이동
- 지도에서 해당 마커 강조 표시
- 상세 정보 영역에 확장 표시

**상세 정보** (장소 항목 또는 마커 선택 시 표시):

- 주소: 도로명 주소 또는 지번 주소
- 전화번호: 연락처 (있는 경우)
- 영업 상태: 영업 중/영업 종료 (있는 경우)
- 카카오맵에서 자세히 보기 기능 제공: 카카오맵 장소 상세 페이지 새 창으로 열기

**로딩 및 에러 처리**:

- 지도 로딩 중: 로딩 상태 표시
- 장소 검색 중: 로딩 상태 표시
- 검색 결과 없음: 안내 메시지 표시
- 위치 정보 없음: 에러 메시지 표시 및 수동 위치 입력 옵션 제공

**닫기**:

- 닫기 기능 제공 → 이전 화면으로 돌아가기

---

## 9. 위험 신호 감지 플로우

### 9.1 자동 위험 분석

**트리거**:

- 로그인 성공 후 다이어리 메인 화면 진입 시 **한 번만** 실행

**분석 과정**:

- 시스템: 관리자가 설정한 모니터링 기간(관리자 명세서 4.2 참조)만큼 최근 일기 데이터 조회
- 감정 패턴 분석:
  - 부정 감정 심각도별 점수 계산 (고위험: 슬픔, 분노 = 2점, 중위험: 불안, 혐오 = 1점)
  - 연속 부정 감정 점수 계산
  - 모니터링 기간 내 부정 감정 점수 합계 계산
  - 위험 레벨 판정 (none/low/medium/high)

**위험 레벨 기준**:

- 시스템이 관리자가 설정한 기준(관리자 명세서 4.2 참조)에 따라 위험 레벨을 판정합니다
- **High**: 관리자가 설정한 High 레벨 판정 기준을 충족하는 경우
- **Medium**: 관리자가 설정한 Medium 레벨 판정 기준을 충족하는 경우 (High 기준 미충족 시)
- **Low**: 관리자가 설정한 Low 레벨 판정 기준을 충족하는 경우 (High/Medium 기준 미충족 시)
- **None**: 위의 기준을 모두 충족하지 않는 경우

---

### 9.2 위험 알림 표시

**조건**:

- 위험 레벨이 medium 이상인 경우

**표시 시점**: 로그인 성공 후 다이어리 메인 화면 진입 시 **한 번만** 표시

- 세션 중에는 다시 표시하지 않음
- 로그아웃 후 재로그인 시에만 다시 확인

**표시 내용**:

- 위험 레벨별 구분 표시
- 위험 레벨별 메시지 표시
- 감지된 위험 신호 이유 표시:
  - 연속 부정 감정 기준 충족 시: 해당 안내 표시
  - 모니터링 기간 내 부정 감정 기준 충족 시: 해당 안내 표시
  - 둘 다 충족 시: 둘 다 표시
- High 레벨인 경우: 관리자가 설정한 긴급 상담 기관의 전화번호 표시 (관리자 명세서 4.3의 "긴급 상담 기관으로 표시"로 설정된 기관의 전화번호)

**사용자 선택지**:

1. **도움말 & 리소스 보기 기능**

   - 실행 → 지원 리소스 페이지로 이동
   - 결과 표시 닫기

2. **닫기 기능**
   - 실행 → 결과 표시 닫기 (메인 화면 계속 사용)

---

### 9.3 지원 리소스 페이지

**화면 전환**:

- 위험 알림 표시에서 도움말 & 리소스 보기 기능 실행 → 지원 리소스 페이지로 이동
- 마이페이지에서 직접 접근 → 지원 리소스 페이지로 이동

**위험 신호 경고 메시지**:

- 위험 신호가 있는 경우 경고 메시지 표시

**카테고리 필터**:

- 카테고리 필터 기능 제공:
  - 전체
  - 긴급 상담
  - 전문 상담
  - 상담 전화
  - 의료 기관
- 필터 선택 시 해당 카테고리의 리소스 목록 표시

**리소스 목록**:

- 필터별 리소스 목록 표시
- 각 리소스 정보:
  - 기관명
  - 설명
  - 전화번호
  - 웹사이트 (새 창 열기)
  - 운영 시간

**안내 정보**:

- 도움 요청에 대한 안내
- 긴급 상황 안내
- 상담이 도움이 되는 경우 설명

---

## 10. 마이페이지 및 설정 변경 플로우

### 10.1 마이페이지 진입

**화면 전환**:

- 북마크 네비게이션에서 마이페이지 기능 실행
- 마이페이지로 이동

---

### 10.2 프로필 정보 확인 및 수정

**프로필 정보**:

1. **이메일 확인** (수정 불가)

   - 현재 이메일 주소 표시
   - 수정 불가

2. **이름 확인** (수정 불가)

   - 회원가입 시 입력한 이름 표시
   - 수정 불가

3. **성별 확인** (수정 불가)

   - 회원가입 시 선택한 성별 표시 (남성/여성)
   - 수정 불가

4. **AI 코멘트 말투 변경**

   - 현재 선택된 페르소나 표시
   - 변경 기능 실행 → 페르소나 선택 기능 표시
   - **페르소나 선택**:
     - 6가지 페르소나 선택 기능 제공:
       - 베프 (친근하고 공감적)
       - 부모님 (따뜻하고 지지적)
       - 전문가 (전문적이고 분석적)
       - 멘토 (동기부여하는 성장 코치)
       - 상담사 (심리 분석 중심 치유자)
       - 시인 (감성적이고 철학적)
     - 페르소나 선택 시 미리보기 표시 기능 제공
     - 수정 기능 실행 (선택 필수)
   - 저장 및 완료:
     - 선택한 페르소나 저장
     - 변경 완료 메시지 표시
     - 선택 기능 닫기
     - 이후 작성되는 일기의 AI 코멘트에 새로운 페르소나 말투 적용
     - 참고: 기존에 작성된 일기의 AI 코멘트는 변경되지 않음

5. **도움말 & 지원 리소스**

   - 지원 리소스 페이지로 이동하는 기능 제공

6. **공지사항**
   - 공지사항 목록 표시 기능 제공

---

### 10.3 비밀번호 변경

**비밀번호 변경 기능**:

1. **비밀번호 변경 시작**

   - 비밀번호 변경 기능 실행 → 변경 모드 진입

2. **비밀번호 입력**

   - 현재 비밀번호 입력 필드 제공 (표시/숨김 기능 제공)
   - 비밀번호 찾기 페이지로 이동하는 기능 제공
   - 새 비밀번호 입력 필드 제공 (표시/숨김 기능 제공)
   - 시스템: 실시간 검증 (최소 8자, 영문/숫자/특수문자 포함)
   - 조건 미충족 시 → 에러 메시지 표시
   - 새 비밀번호 확인 입력 필드 제공 (표시/숨김 기능 제공)
   - 시스템: 비밀번호 일치 여부 실시간 검증
   - 불일치 시 → 에러 메시지 표시

3. **변경 완료**

   - 변경 완료 기능 실행
   - 검증 통과 → 비밀번호 변경 API 호출
   - 성공 메시지 표시
   - 입력 필드 초기화

4. **변경 취소**
   - 취소 기능 실행 → 변경 모드 종료, 입력 필드 초기화

---

### 10.4 공지사항 조회

**화면 전환**:

- 마이페이지에서 공지사항 기능 실행
- 공지사항 목록 표시

**공지사항 목록**:

- 관리자가 작성한 공지사항 목록 표시
- 고정된 공지사항 우선 정렬
- 이후 작성일 최신순 정렬

**각 공지사항 항목 표시**:

- 제목
- 작성일
- 고정 여부 (고정된 경우 표시)
- 공지사항 항목 선택 → 공지사항 상세 표시

**공지사항 상세**:

- 공지사항 제목
- 작성일
- 고정 여부 (고정된 경우 표시)
- 공지사항 내용 (HTML 렌더링)
- 닫기 기능 제공 → 상세 표시 닫기

**데이터 로드**:

- 공지사항 목록 표시 시 자동 로드
- 로딩 상태 표시
- 공개 상태인 공지사항만 표시 (비공개 공지사항은 제외)

**공지사항이 없는 경우**:

- 안내 메시지 표시

**닫기**:

- 닫기 기능 제공 → 목록 표시 닫기
- 상세 표시에서 닫기 기능 제공 → 상세 표시만 닫기, 목록 표시는 유지

---

### 10.5 계정 탈퇴

**계정 탈퇴 기능**:

1. **탈퇴 시작**

   - 계정 탈퇴 기능 실행 → 탈퇴 확인 영역 표시

2. **탈퇴 확인**

   - 경고 메시지 표시
   - 탈퇴 확인 실행 → 계정 삭제 API 호출
   - 취소 선택 → 탈퇴 취소

3. **탈퇴 완료**
   - 토큰 삭제
   - 사용자 데이터 삭제
   - 랜딩 페이지로 이동

---

## 11. 로그아웃 플로우

### 11.1 로그아웃 실행

**화면 전환**:

- 북마크 네비게이션에서 로그아웃 기능 실행

**프로세스**:

1. 로그아웃 확인 기능 표시
2. 로그아웃 확인 실행 → 토큰 삭제, 사용자 데이터 삭제
3. 랜딩 페이지로 이동
4. 취소 선택 → 확인 기능 닫기

---

## 12. 네비게이션 플로우

### 12.1 북마크 네비게이션

**화면**: 모든 화면에 북마크 네비게이션 표시

**북마크 기능**:

1. **홈**

   - 실행 → 캘린더 메인 화면으로 이동

2. **감정 통계**

   - 실행 → 감정 통계 페이지로 이동

3. **일기 검색**

   - 실행 → 일기 검색 페이지로 이동

4. **마이페이지**

   - 실행 → 마이페이지로 이동

5. **로그아웃**
   - 실행 → 로그아웃 확인 기능 표시 (11.1 참조)

---

## 13. 데이터 동기화 및 자동 업데이트

### 13.1 자동 새로고침

**트리거 상황**:

- 일기 작성/수정/삭제 후
- 캘린더 화면으로 돌아올 때
- 월 변경 시

**처리 과정**:

- 관련 데이터 자동 재조회
- 화면 자동 업데이트
- 감정 이모지 자동 갱신
- 일기 삭제 후: 해당 날짜의 감정 이모지 제거, 빈 날짜로 표시

---

## 14. 에러 처리 플로우

### 14.1 입력 검증 에러

**처리 방식**:

- 실시간 검증: 입력 즉시 에러 메시지 표시/제거
- 제출 시 검증: 모든 필수 항목 최종 확인
- 에러 메시지: 에러 메시지 표시

---

### 14.2 API 에러

**처리 방식**:

- 네트워크 에러: 에러 메시지 표시
- 인증 에러: 로그인 페이지로 리다이렉트
- 기타 에러: 각 화면에서 적절한 에러 메시지 표시

---

### 14.3 로딩 상태

**표시 방식**:

- API 호출 중: 로딩 상태 표시
- 실행 중인 기능에 대한 로딩 상태 표시
- 화면 전체: 로딩 상태 표시

---

## 15. 특수 기능 및 상호작용

### 15.1 키보드 단축키

- Enter 키: 활동 추가, 검색 실행
- 비밀번호 필드: 표시/숨김 토글

## 회원 탈퇴 및 재가입 프로세스 (변경)

### 1. 회원 탈퇴

- 사용자가 탈퇴를 요청하면 계정 상태를 '삭제됨(Soft Delete)'으로 변경합니다.
- 탈퇴 후에는 로그인이 불가능합니다.
- 기존 데이터(일기, 설정 등)는 재가입 전까지 보존됩니다.

### 2. 재가입

- 탈퇴한 사용자가 동일한 이메일로 가입을 시도하면 **재가입 프로세스**가 진행됩니다.
- 재가입 시, 보안 및 데이터 정리를 위해 **이전 계정의 모든 데이터가 영구 삭제**됩니다.
- 이후 신규 회원으로 가입 처리됩니다.
